FROM centos:centos7

MAINTAINER RAKOTOARISOA Jérémy <jeremy.rakotoarisoa@gmail.com>

RUN yum update -y

RUN yum upgrade -y

RUN yum install -y \
    httpd \
    php \
    sendmail
 
RUN yum clean all

COPY www /www
COPY src www/vulnerable/

RUN chmod 777 -R /www

RUN mkdir /etc/httpd/sites-available && mkdir /etc/httpd/sites-enabled

COPY virtual-host /etc/httpd/sites-available/000-default.conf

COPY httpd.conf /etc/httpd/conf/

RUN ln -s /etc/httpd/sites-available/000-default.conf /etc/httpd/sites-enabled/000-default.conf

EXPOSE 80

RUN systemctl enable httpd.service

COPY main.sh /
ENTRYPOINT ["/usr/sbin/init"]
CMD ["default"]
